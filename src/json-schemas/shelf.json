{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "http://mycs.com/schemas/furniture/shelf",
  "definitions": {
    "sku": {
      "type": "string",
      "description": "unique id of a component in our furniture component store",
      "pattern": "^(\\d+\\.)+[\\d]+$"
    },
    "position": {
      "type": "number",
      "description": "position by X of the element"
    },
    "h_position": {
      "type": "number",
      "description": "position by Z of the element"
    },
    "element": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "sku" ],
      "properties": {
        "sku": { "$ref": "#/definitions/sku" }
      }
    },
    "positioned_element": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "sku", "position" ],
      "properties": {
        "sku": { "$ref": "#/definitions/sku" },
        "position": { "$ref": "#/definitions/position" }
      }
    },
    "vertically_positioned_element": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "sku", "position", "h_position" ],
      "properties": {
        "sku": { "$ref": "#/definitions/sku" },
        "position": { "$ref": "#/definitions/position" },
        "h_position": { "$ref": "#/definitions/h_position" }
      }
    },
    "legs": {
      "type": "array",
      "description": "type for shelf's legs",
      "minItems": 1,
      "items": { "$ref": "#/definitions/element" }
    },
    "handle_type": {
      "type": "string",
      "enum": [ "center", "left", "right" ]
    },
    "handle_element": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "sku", "position", "h_position", "type" ],
      "properties": {
        "sku": { "$ref": "#/definitions/sku" },
        "position": { "$ref": "#/definitions/position" },
        "h_position": { "$ref": "#/definitions/h_position" },
        "type": { "$ref": "#/definitions/handle_type" }
      }
    }
  },
  "type": "object",
  "additionalProperties": false,
  "required": [ "columns" ],
  "properties": {
    "columns": {
      "type": "array",
      "uniqueItems": true,
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [ "boards", "fronts", "position", "wallLeft", "wallRight" ],
        "dependencies": {
          "legPlatforms": [ "legs" ],
          "legs": [ "legPlatforms" ]
        },
        "properties": {
          "position": { "$ref": "#/definitions/position" },
          "wallLeft": {
            "type": "array",
            "uniqueItems": true,
            "items": { "$ref": "#/definitions/element" }
          },
          "wallRight": {
            "type": "array",
            "uniqueItems": true,
            "minItems": 1,
            "items": { "$ref": "#/definitions/element" }
          },
          "backwalls": {
            "type": "array",
            "uniqueItems": true,
            "items": { "$ref": "#/definitions/positioned_element" }
          },
          "boards": {
            "type": "array",
            "uniqueItems": true,
            "minItems": 2,
            "items": { "$ref": "#/definitions/positioned_element" }
          },
          "fronts": {
            "type": "array",
            "uniqueItems": true,
            "items": { "$ref": "#/definitions/vertically_positioned_element" }
          },
          "handles": {
            "type": "array",
            "uniqueItems": true,
            "items": { "$ref": "#/definitions/handle_element" }
          },
          "legPlatforms": { "$ref": "#/definitions/legs" },
          "legs": { "$ref": "#/definitions/legs" }
        }
      }
    }
  }
}